- [–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –µ—Å–ª–∏ —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É 1 –∞ –ø–æ—Ç–æ–º –Ω–∞ –∫–Ω–æ–ø–∫—É 2?](#—á—Ç–æ-–ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç-–µ—Å–ª–∏-—Å–Ω–∞—á–∞–ª–∞-–Ω–∞–∂–∞—Ç—å-–Ω–∞-–∫–Ω–æ–ø–∫—É-1-–∞-–ø–æ—Ç–æ–º-–Ω–∞-–∫–Ω–æ–ø–∫—É-2)
- [–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ–¥–∞?](#—á—Ç–æ-–ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç-–ø—Ä–∏-–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏-—Å–ª–µ–¥—É—é—â–µ–≥–æ-–∫–æ–¥–∞)
- [–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã: retain, release, autorelease](#—Ä–µ–∞–ª–∏–∑—É–π—Ç–µ-—Å–ª–µ–¥—É—é—â–∏–µ-–º–µ—Ç–æ–¥—ã-retain-release-autorelease)
- [–í—ã–≤–µ–¥–µ—Ç—Å—è –ª–∏ –≤ –¥–µ–±–∞–≥–µ—Ä Hello world? –ü–æ—á–µ–º—É?](#–≤—ã–≤–µ–¥–µ—Ç—Å—è-–ª–∏-–≤-–¥–µ–±–∞–≥–µ—Ä-hello-world-–ø–æ—á–µ–º—É)
- [–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å?](#—á—Ç–æ-–≤—ã–≤–µ–¥–µ—Ç—Å—è-–≤-–∫–æ–Ω—Å–æ–ª—å)
- [–ó–∞–¥–∞—á–∞ –ø—Ä–æ –±–∞–Ω–µ—Ä–æ–∫—Ä—É—Ç–∏–ª–∫—É](#–∑–∞–¥–∞—á–∞-–ø—Ä–æ-–±–∞–Ω–µ—Ä–æ–∫—Ä—É—Ç–∏–ª–∫—É)
- [–ó–∞–¥–∞—á–∞ –Ω–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ](#–∑–∞–¥–∞—á–∞-–Ω–∞-—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ)
- [–ú–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π N –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —Å–ª–æ–≤ –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ](#–º–µ—Ç–æ–¥-–≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π-n-–Ω–∞–∏–±–æ–ª–µ–µ-—á–∞—Å—Ç–æ-–≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è-—Å–ª–æ–≤-–≤–æ-–≤—Ö–æ–¥–Ω–æ–π-—Å—Ç—Ä–æ–∫–µ)
- [–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–∏–¥–∏—Ç–µ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –∫–æ–¥–µ. –ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ, –∫–∞–∫ –∏—Ö –∏—Å–ø—Ä–∞–≤–∏—Ç—å](#–ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ-–≤—Å–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∫–æ—Ç–æ—Ä—ã–µ-–≤—ã-–≤–∏–¥–∏—Ç–µ-–≤-–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º-–Ω–∏–∂–µ-–∫–æ–¥–µ-–ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ-–∫–∞–∫-–∏—Ö-–∏—Å–ø—Ä–∞–≤–∏—Ç—å)
- [–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É –±—É–∫–≤–∞–º–∏ –ê, —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω—ã –∏—Ç–µ—Ä–∞—Ü–∏–π](#–∑–∞–ø–æ–ª–Ω–∏—Ç—å-—Å—Ç—Ä–æ–∫—É-–±—É–∫–≤–∞–º–∏-–∞-—á—Ç–æ–±—ã-–Ω–µ-–¥–µ–ª–∞—Ç—å-–º–∏–ª–ª–∏–æ–Ω—ã-–∏—Ç–µ—Ä–∞—Ü–∏–π)
- [–ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É, –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—â—É—é –º–∞—Å—Å–∏–≤ —Å–∏–º–≤–æ–ª–æ–≤](#–Ω–∞–ø–∏—Å–∞—Ç—å-–ø—Ä–æ—Ü–µ–¥—É—Ä—É-–∏–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—â—É—é-–º–∞—Å—Å–∏–≤-—Å–∏–º–≤–æ–ª–æ–≤)
- [–ß—Ç–æ –Ω–µ —Ç–∞–∫ —Å —ç—Ç–∏–º –∫–æ–¥–æ–º?](#—á—Ç–æ-–Ω–µ-—Ç–∞–∫-—Å-—ç—Ç–∏–º-–∫–æ–¥–æ–º)
- [–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –≤—ã–∑–æ–≤–µ—Ç—Å—è: –∫–ª–∞—Å—Å–∞ A –∏–ª–∏ –∫–ª–∞—Å—Å–∞ B?](#–∫–∞–∫–æ–π-–º–µ—Ç–æ–¥-–≤—ã–∑–æ–≤–µ—Ç—Å—è-–∫–ª–∞—Å—Å–∞-a-–∏–ª–∏-–∫–ª–∞—Å—Å–∞-b)
- [`int8_t matrix [2048][2024]`, –¥–æ–ø—É—Å—Ç–∏–º–æ –ª–∏?](#int8_t-matrix-20482024-–¥–æ–ø—É—Å—Ç–∏–º–æ-–ª–∏)
- [–û–¥–∏–Ω–∞–∫–æ–≤—É—é –ª–∏ –ø–∞–º—è—Ç—å –∑–∞–Ω–∏–º–∞—é—Ç —ç—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ø–æ—á–µ–º—É —Ç–∞–∫?](#–æ–¥–∏–Ω–∞–∫–æ–≤—É—é-–ª–∏-–ø–∞–º—è—Ç—å-–∑–∞–Ω–∏–º–∞—é—Ç-—ç—Ç–∏-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã-–∏-–ø–æ—á–µ–º—É-—Ç–∞–∫)
- [–ë—É–¥–µ—Ç –ª–∏ –≤—ã–∑–≤–∞–Ω deinit —É A –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ test()?](#retain-in-class)
- [–ë—É–¥–µ—Ç –ª–∏ –≤—ã–∑–≤–∞–Ω deinit —É ViewModel –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ test()? –ß—Ç–æ –Ω–µ —Ç–∞–∫? –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?](#retain-in-vm)
- [–ó–∞–¥–∞—á–∞ –Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü](#web)
- [–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞](#–ø–æ—Ä—è–¥–æ–∫)
- [–ó–∞–¥–∞—á–∞ –Ω–∞ QOS](#qos)
- [–ó–∞–¥–∞—á–∞ –Ω–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—é](#dispatch)

<a name="string-autorelease"></a>

## –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –µ—Å–ª–∏ —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É 1 –∞ –ø–æ—Ç–æ–º –Ω–∞ –∫–Ω–æ–ø–∫—É 2?

```objectivec
- (IBAction)btn1DidTouch:(id)sender {
 _string = [[[NSString alloc] initWithFormat:@"v=%i", rand()] autorelease];
}
- (IBAction)btn2DidTouch:(id)sender {
 NSLog(@"_string is equal to ‚Äò%@‚Äô", _string);
}
```

–ö—Ä—ç—à, —Ç.–∫ utoreleasepool —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è –∏ —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ. —Ç.–µ. –Ω–∞–∂–∞–ª–∏ –Ω–∞ –ø–µ—Ä–≤—É—é –∫–Ω–æ–ø–∫—É ‚Äî –Ω–∞—á–∞–ª–∞—Å—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è, –Ω–∞–∂–∞–ª–∏ –Ω–∞ –≤—Ç–æ—Ä—É—é ‚Äî –∫–Ω–æ–ø–∫—É ‚Äî –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è, –æ—á–∏—Å—Ç–∏–ª—Å—è autoreleasepool –∞ –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º –∏ –æ–±—ä–µ–∫—Ç —É–¥–∞–ª–∏–ª—Å—è, –∞ —Å—Å—ã–ª–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å. –ó–∞—Ç–µ–º –Ω–∞—á–∞–ª–∞—Å—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –∏ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –∑–∞–¥–µ–∞–ª–æ—á–µ–Ω–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É, —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –∫—Ä—ç—à.

<a name="—á—Ç–æ-–ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç"></a>

## –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ–¥–∞?

```objectivec
Ball *ball = [[[[Ball alloc] init] autorelease] autorelease];
```

–í–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ —ç—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –∫—Ä—ç—à. –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–±—ä–µ–∫—Ç –¥–≤–∞–∂–¥—ã –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø—É–ª –∞–≤—Ç–æ–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è, –∏ `release` –≤—ã–∑–æ–≤–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã.

<a name="retain-release-autorelease"></a>

## –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã: retain, release, autorelease

```objectivec
- (id)retain {
 NSIncrementExtraRefCount(self);
 return self;
}

- (void)release {
 if (NSDecrementExtraRefCountWasZero(self)) {
  NSDeallocateObject(self);
 }
}

- (id)autorelease {  
 // Add the object to the autorelease pool
 [NSAutoreleasePool addObject:self];
 return self;
}
```

<a name="hello-world"></a>

## –í—ã–≤–µ–¥–µ—Ç—Å—è –ª–∏ –≤ –¥–µ–±–∞–≥–µ—Ä Hello world? –ü–æ—á–µ–º—É?

```objectivec
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
  dispatch_sync(dispatch_get_main_queue(), ^{
    NSLog(@"Hello world");
  });
  /* Another implementation */
  return YES;
}
```

–ù–µ—Ç. deadlock

## –ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å?

```objectivec
NSObject *object = [NSObject new];
dispatch_async(dispatch_get_main_queue(), ^ {
  NSLog(@"A %d", [object retainCount]);
  dispatch_async(dispatch_get_main_queue(), ^ {
    NSLog(@"B %d", [object retainCount]);
  });
  NSLog(@"C %d", [object retainCount]);
});
NSLog(@"D %d", [object retainCount]);
```

```
D 2
A 2
C 3
B 2
```

<a name="–∑–∞–¥–∞—á–∞-–ø—Ä–æ-–±–∞–Ω–µ—Ä–æ–∫—Ä—É—Ç–∏–ª–∫—É"></a>

## –ó–∞–¥–∞—á–∞ –ø—Ä–æ –±–∞–Ω–µ—Ä–æ–∫—Ä—É—Ç–∏–ª–∫—É

–ò–∑ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤—ã–≤–µ—Å—Ç–∏ –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ, —Ä–∞–Ω–¥–æ–º–Ω–æ, –∞ –≥–ª–∞–≤–Ω–æ–µ, –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π, –≤—Å–µ –µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç—ã.

```java
import java.util.Random;
class Banner
{
  public static void main(String[] args)
  {
    Random r = new Random();
    int[] list = new int[100];// –≤ —É–≥–æ–¥—É –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –≤ –¥–µ–±—Ä–∏ –ª–∏–Ω–∫–µ–¥–ª–∏—Å—Ç–æ–≤ –ª–µ–∑—Ç—å –Ω–µ –±—É–¥–µ–º
    for (int i = 0; i < 100; ++i)
    {
      list[i] = i;
    }
    /*–ê —Ç–µ–ø–µ—Ä—å –≥–ª–∞–≤–Ω–æ–µ - –ª–æ–≥–∏–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞*/
    int index = 99;
    int number;
    while (index > 0)
    {
      number = r.nextInt(index);
      System.out.println(list[number]);
      list[number] = list[index];
      --index;
    }
  }
}
```

–¢–µ–ø–µ—Ä—å –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ —Å—É—Ç–∏, —á—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –ü–æ–∫–∞ –≤ —Å–ø–∏—Å–∫–µ –µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã, –º—ã –±–µ—Ä–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞, –≤—ã–≤–æ–¥–∏–º –µ–≥–æ, –ø–æ—Ç–æ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å—Ç–∞–≤–∏–º –Ω–∞ –º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤—ã–≤–µ–¥–µ–Ω–Ω–æ–≥–æ, –∞ –∏–Ω–¥–µ–∫—Å –¥–ª–∏–Ω—ã —É–º–µ–Ω—å—à–∞–µ–º –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É, –ø–æ–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∏—á–µ–≥–æ.

<a name="–∑–∞–¥–∞—á–∞-–Ω–∞-—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ"></a>

## –ó–∞–¥–∞—á–∞ –Ω–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ

–í —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–∏–Ω–∞: –æ–Ω –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –ª–∞—Ç–∏–Ω—Å–∫–æ–π –±—É–∫–≤—ã, –º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö –±—É–∫–≤, —Ü–∏—Ñ—Ä, —Ç–æ—á–∫–∏ –∏ –º–∏–Ω—É—Å–∞ –∏ –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –ª–∞—Ç–∏–Ω—Å–∫–æ–π –±—É–∫–≤–æ–π –∏–ª–∏ —Ü–∏—Ñ—Ä–æ–π. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ª–æ–≥–∏–Ω–∞ ‚Äî 1 —Å–∏–º–≤–æ–ª. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è ‚Äî 20 —Å–∏–º–≤–æ–ª–æ–≤.

```objectivec
BOOL loginTester(NSString* login) {
  NSError *error = NULL;
  NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"\\A[a-zA-Z](([a-zA-Z0-9\\.\\-]{0,18}[a-zA-Z0-9])|[a-zA-Z0-9]){0,1}\\z" options:NSRegularExpressionCaseInsensitive error:&error];
  // –ó–¥–µ—Å—å –Ω–∞–¥–æ –±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏, –Ω–æ –µ—Å–ª–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏
  // –Ω–µ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ - –º–æ–∂–Ω–æ –ø—Ä–µ–Ω–µ–±—Ä–µ—á—å.
  NSRange rangeOfFirstMatch = [regex rangeOfFirstMatchInString:login options:0 range:NSMakeRange(0, [login length])];
  return (BOOL)(rangeOfFirstMatch.location!=NSNotFound);
}
```

<a name="–Ω–∞–∏–±–æ–ª–µ–µ-—á–∞—Å—Ç–æ-–≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è-—Å–ª–æ–≤–∞"></a>

## –ú–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π N –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —Å–ª–æ–≤ –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

```objectivec
- (NSArray *)mostFrequentWordsInString:(NSString *)string count:(NSUInteger)count {
  // –ø–æ–ª—É—á–∞–µ–º –º–∞—Å—Å–∏–≤ —Å–ª–æ–≤.
  // —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏—Ö —è–∑—ã–∫–æ–≤ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ö–æ—Ä–æ—à–æ.
  // –¥–ª—è —è–∑—ã–∫–æ–≤, –≤—Ä–æ–¥–µ –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ, –∏–ª–∏ –∫–æ–≥–¥–∞ —è–∑—ã–∫ –∑–∞—Ä–∞–Ω–µ–µ –Ω–µ –∏–∑–≤–µ—Å—Ç–µ–Ω,
  // –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å enumerateSubstringsInRange —Å –æ–ø—Ü–∏–µ–π NSStringEnumerationByWords
  NSMutableCharacterSet *separators = [[NSCharacterSet whitespaceAndNewlineCharacterSet] mutableCopy];
  [separators formUnionWithCharacterSet:[NSCharacterSet punctuationCharacterSet]];
  NSArray *words = [string componentsSeparatedByCharactersInSet:separators];
  NSCountedSet *set = [NSCountedSet setWithArray:words];
  // —Ç—É—Ç –±—ã –ø—Ä–∏–≥–æ–¥–∏–ª—Å—è enumerateByCount, –Ω–æ –µ–≥–æ –Ω–µ—Ç.
  // –±—É–¥–µ–º —Å—Ç—Ä–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é
  NSMutableArray *selectedWords = [NSMutableArray arrayWithCapacity:count];
  NSMutableArray *countsOfSelectedWords = [NSMutableArray arrayWithCapacity:count];
  for (NSString *word in set) {
    NSUInteger wordCount = [set countForObject:word];
    NSNumber *countOfFirstSelectedWord = [countsOfSelectedWords count] ? [countsOfSelectedWords objectAtIndex:0] : nil; // –≤ iOS 7 –ø–æ—è–≤–∏–ª—Å—è firstObject
    if ([selectedWords count] < count || wordCount >= [countOfFirstSelectedWord unsignedLongValue]) {
      NSNumber *wordCountNSNumber = [NSNumber numberWithUnsignedLong:wordCount];
      NSRange range = NSMakeRange(0, [countsOfSelectedWords count]);
      NSUInteger indexToInsert = [countsOfSelectedWords indexOfObject:wordCountNSNumber inSortedRange:range options:NSBinarySearchingInsertionIndex usingComparator:^(NSNumber *n1, NSNumber *n2) {
        NSUInteger _n1 = [n1 unsignedLongValue];
        NSUInteger _n2 = [n2 unsignedLongValue];
        if (_n1 == _n2)
          return NSOrderedSame;
        else if (_n1 < _n2)
          return NSOrderedAscending;
        else
          return NSOrderedDescending;
        }];
        [selectedWords insertObject:word atIndex:indexToInsert];
        [countsOfSelectedWords insertObject:wordCountNSNumber atIndex:indexToInsert];
        // –µ—Å–ª–∏ —Å–ª–æ–≤ —É–∂–µ –µ—Å—Ç—å –±–æ–ª—å—à–µ —á–µ–º –Ω—É–∂–Ω–æ, —É–¥–∞–ª—è–µ–º —Ç–æ —á—Ç–æ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ–º
        if ([selectedWords count] > count) {
          [selectedWords removeObjectAtIndex:0];
          [countsOfSelectedWords removeObjectAtIndex:0];
        }
      }
    }
    return [selectedWords copy];
    // –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —Å—Ä–∞–∑—É –≤–µ—Ä–Ω—É—Ç—å selectedWords,
    // –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤–º–µ—Å—Ç–æ immutable –∫–ª–∞—Å—Å–∞ –µ–≥–æ mutable —Å–∞–±–∫–ª–∞—Å –Ω–µ—Ö–æ—Ä–æ—à–æ - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –±–∞–≥–∞–º
}
// –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —é–Ω–∏—Ç–µ—Å—Ç–æ–≤: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º –∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ—Ä—è–¥–∫–∞ —Å–ª–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ.
```

–Ø –±—ã –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª, –µ—Å–ª–∏ –±—ã –º–Ω–µ –Ω—É–∂–Ω–æ –±—ã–ª–æ —Ä–µ—à–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ —è –ø–æ–Ω–∏–º–∞—é, –æ—Ç–∫—É–¥–∞ –±—É–¥—É—Ç –±—Ä–∞—Ç—å—Å—è –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é, —á—Ç–æ —Ä–∞–∑–º–µ—Ä—ã –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–µ –±—É–¥—É—Ç –±–æ–ª—å—à–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–≥–∞–±–∞–π—Ç. –í–ø–æ–ª–Ω–µ —Ä–∞–∑—É–º–Ω–æ–µ –¥–æ–ø—É—â–µ–Ω–∏–µ –¥–ª—è iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥. –ò–Ω–∞—á–µ –Ω–∞ –≤—Ö–æ–¥–µ –Ω–µ –±—ã–ª–æ –±—ã —Å—Ç—Ä–æ–∫–∏, –∞ –±—ã–ª –±—ã —Ñ–∞–π–ª. –ü—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ –±–æ–ª—å—à–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–π–¥–µ—Ç—Å—è –ø–æ–ø–æ—Ç–µ—Ç—å –Ω–∞–¥ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä–∞ —Å–ª–æ–≤, —á—Ç–æ–± –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞. –¢–∞–∫–æ–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –æ—á–µ–Ω—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —è–∑—ã–∫–∞ ‚Äî —Ç–æ —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ –Ω–µ –ø—Ä–æ–∫–∞–Ω–∞–µ—Ç –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ. –ê –≤–æ—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å–æ —Å–ª–æ–≤–∞–º–∏ –¥–∞–ª—å—à–µ ‚Äî –∫—Ä–æ–º–µ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ –≥–æ–ª–æ–≤—É –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç. –ï—Å–ª–∏ –±—ã –Ω—É–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω–æ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–µ–µ—Å—è —Å–ª–æ–≤–æ ‚Äî —ç—Ç–æ Fast Majority Voting. –ù–æ –≤—Å—è –∫—Ä–∞—Å–æ—Ç–∞ —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ N –∑–Ω–∞—á–µ–Ω–∏–π –º–Ω–µ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω—ã. –°–∞–º–æ–º—É –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å.

<a name="–ø—Ä–æ–±–ª–µ–º—ã-–≤-–∫–æ–¥–µ"></a>

## –ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–∏–¥–∏—Ç–µ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –∫–æ–¥–µ. –ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ, –∫–∞–∫ –∏—Ö –∏—Å–ø—Ä–∞–≤–∏—Ç—å

```objectivec
NSOperation *operation = [NSBlockOperation blockOperationWithBlock:^{
  for (int i = 0; i < 1000; ++i) {
    if ([operation isCancelled]) return;
    process(data[i]);
  }
  }];
  [queue addOperation:operation];
  ```

  –õ–∏—á–Ω–æ —è –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É –≤ —Ç–æ–º, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è operation, ¬´–∑–∞—Ö–≤–∞—á–µ–Ω–Ω–∞—è¬ª –±–ª–æ–∫–æ–º –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–ª–æ–∫–∞, –µ—â–µ –Ω–µ –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–æ –∫–æ–Ω—Ü–∞. –ö–∞–∫–æ–µ —Ä–µ–∞–ª—å–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –±—É–¥–µ—Ç –≤ –º–æ–º–µ–Ω—Ç ¬´–∑–∞—Ö–≤–∞—Ç–∞¬ª, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –º–µ—Ç–æ–¥–µ –∫–ª–∞—Å—Å–∞ –∏–ª–∏ –≤ –ø—Ä–æ—Å—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –í–ø–æ–ª–Ω–µ –≤–æ–∑–º–æ–∂–Ω–æ, —á—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –±—É–¥–µ—Ç –≤–ø–æ–ª–Ω–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω –∏ —Ç–∞–∫, –Ω–æ –º–Ω–µ —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ —è—Å–µ–Ω. –ö–∞–∫ –≤—ã–π—Ç–∏ –∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏? –¢–∞–∫:

  ```objectivec
  NSBlockOperation *operation = [[NSBlockOperation alloc] init];
  [operation addExecutionBlock:^{
    for (int i = 0; i < 1000; ++i) {
      if ([operation isCancelled]) return;
      process(data[i]);
    }
  }];
  [queue addOperation:operation];
  ```

  –í–æ–∑–º–æ–∂–Ω–æ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã–ª–æ –±—ã –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä `__block` –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π operation. –ù–æ —Ç–∞–∫, –∫–∞–∫ –≤ –∫–æ–¥–µ –≤—ã—à–µ ‚Äî –Ω–∞–≤–µ—Ä–Ω—è–∫–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–∂–µ —Å–æ–∑–¥–∞—é—Ç `__weak` –∫–æ–ø–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π operation –∏ –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–µ. –•–æ—Ä–æ—à–æ –ø–æ–¥—É–º–∞–≤ —è —Ä–µ—à–∏–ª, —á—Ç–æ –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –∏–∑–≤–µ—Å—Ç–Ω–æ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π operation –∏ –±–ª–æ–∫–∞ ‚Äî —ç—Ç–æ –∏–∑–ª–∏—à–Ω–µ. –ù—É –∏ —è –±—ã –ø–æ–¥—É–º–∞–ª, —Å—Ç–æ–∏—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `NSBlockOperation` –¥–ª—è —Ç–∞–∫–∏—Ö —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –†–∞–∑—É–º–Ω—ã—Ö –¥–æ–≤–æ–¥–æ–≤ –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–µ –º–æ–≥—É ‚Äî –≤–æ–ø—Ä–æ—Å –ª–∏—á–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π.
  –ß—Ç–æ –µ—â–µ —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –Ω–µ —Ç–∞–∫? –Ø –Ω–µ –ª—é–±–ª—é —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤ –∫–æ–¥–µ –∏ –≤–º–µ—Å—Ç–æ 1000 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±—ã `define`, `const`, `sizeof` –∏–ª–∏ —á—Ç–æ-—Ç–æ –≤ —ç—Ç–æ–º —Ä–æ–¥–µ.
  –í –¥–ª–∏–Ω–Ω—ã—Ö —Ü–∏–∫–ª–∞—Ö –≤ objective-c –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –æ–± autoreleased –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏, –µ—Å–ª–∏ —Ç–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –º–µ—Ç–æ–¥–µ process, –∞ —Å–∞–º —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–± —ç—Ç–æ–º –Ω–µ –∑–∞–±–æ—Ç–∏—Ç—Å—è, –Ω—É–∂–Ω–æ –∑–∞–≤–µ—Ä–Ω—É—Ç—å —ç—Ç–æ—Ç –≤—ã–∑–æ–≤ –≤ `@autoreleasepool {}`. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—É–ª–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –Ω–∞–∫–ª–∞–¥–Ω—ã–º –∏–ª–∏ –∏–∑–ª–∏—à–Ω–∏–º. –ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ARC, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π NSAutoreleasePool –∫–∞–∂–¥—ã–µ, –¥–æ–ø—É—Å—Ç–∏–º, 10 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ARC, —Ç–∞–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ—Ç. –ö—Å—Ç–∞—Ç–∏, —ç—Ç–æ, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–≤–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ARC.
  –ü–æ –∫–æ–¥—É –Ω–µ —è—Å–Ω–æ, –º–µ–Ω—è—é—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –ª–∏ –∫—Ç–æ-—Ç–æ –µ—â–µ –∫ —ç—Ç–∏–º –¥–∞–Ω–Ω—ã–º –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö –ø–æ—Ç–æ–∫–æ–≤, –∫–∞–∫–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∑–∞–±–æ—Ç–∏—Ç—Å—è –ª–∏ —Å–∞–º process –æ –º–æ–Ω–æ–ø–æ–ª—å–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ –∫ –¥–∞–Ω–Ω—ã–º —Ç–æ–≥–¥–∞ –∫–æ–≥–¥–∞ —ç—Ç–æ –Ω—É–∂–Ω–æ. –ú–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –ø–æ–∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö.

  Doh. Dear future googlers: of course operation is nil when copied by the block, but it doesn't have to be copied. It can be qualified with `__block` like so:

  ```objectivec
  //THIS MIGHT LEAK! See the update below.
  __block NSBlockOperation *operation = [NSBlockOperation blockOperationWithBlock:^{
    while( ! [operation isCancelled]){
      //do something...
    }
  }];
  ```

_UPDATE:_

Upon further meditation, it occurs to me that this will create a retain cycle under ARC. In ARC, I believe `__block` storage is retained. If so, we're in trouble, because NSBlockOperation also keeps a strong references to the passed in block, which now has a strong reference to the operation, which has a strong reference to the passed in block, which‚Ä¶
It's a little less elegant, but using an explicit weak reference should break the cycle:

```objectivec
NSBlockOperation *operation = [[NSBlockOperation alloc] init];
__weak NSBlockOperation *weakOperation = operation;
[operation addExecutionBlock:^{
  while(![weakOperation isCancelled]){
    //do something...
  }
}];
```

<a name="–∑–∞–ø–æ–ª–Ω–∏—Ç—å-—Å—Ç—Ä–æ–∫—É-–±—É–∫–≤–∞–º–∏-a"></a>

## –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É –±—É–∫–≤–∞–º–∏ –ê, —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω—ã –∏—Ç–µ—Ä–∞—Ü–∏–π

```objectivec
NSString *str = @"a";
for (int i = 0; i< 5000000; i++) {
  str = [str stringByAppendingString:@"a"];
}
```

_–û—Ç–≤–µ—Ç_

```objectivec
str =[@"" stringByPaddingToLength:5000000 withString:@"a" startingAtIndex:0];
```

<a name="–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å-–º–∞—Å—Å–∏–≤-—Å–∏–º–≤–æ–ª–æ–≤"></a>

## –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É, –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—â—É—é –º–∞—Å—Å–∏–≤ —Å–∏–º–≤–æ–ª–æ–≤

__–°–ø–æ—Å–æ–± 1__

```objectivec
// myString is "hi"
NSMutableString *reversedString = [NSMutableString string];
NSInteger charIndex = [myString length];
while (charIndex > 0) {
  charIndex--;
  NSRange subStrRange = NSMakeRange(charIndex, 1);
  [reversedString appendString:[myString substringWithRange:subStrRange]];
}
NSLog(@"%@", reversedString); // outputs "ih"
```

__–°–ø–æ—Å–æ–± 2__

```objectivec
array.reverseObjectEnumerator.allObjects;
```

__–°–ø–æ—Å–æ–± 3__

```c++
#include <string.h>
/* reverse: –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É s (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ s) */
void reverse(char s[]) {
  int c, i, j;
  for (i = 0, j = strlen(s) - 1; i < j; i++, j--) {
    —Å = s[i];
    s[i] = s[j];
    s[j] = c;
  }  
}
```

<a name="—á—Ç–æ-–Ω–µ-—Ç–∞–∫-—Å-—ç—Ç–∏–º-–∫–æ–¥–æ–º"></a>

## –ß—Ç–æ –Ω–µ —Ç–∞–∫ —Å —ç—Ç–∏–º –∫–æ–¥–æ–º?

```objectivec
[[[SomeClass alloc] init] init];
```

–ü—Ä–∏–º–µ—Ä: –µ—Å—Ç—å –∫–ª–∞—Å—Å `A`, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –ø–æ–ª–µ `NSString *b` –∏ –≤ –∏–Ω–∏—Ç–µ —Ç—ã –¥–µ–ª–∞–µ—à—å `_b = @"somestring";` –°—Ç—Ä–∏–Ω–≥ `b` –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–æ–¥ `A` ‚Äì –≤ —ç—Ç–æ–π –ø–∞–º—è—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–∏—à—å —Å—Å—ã–ª–∫–∞ –Ω–∞ `b`, –∞ —Å–∞–º –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤–æ–≤–Ω–µ. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–Ω–∏—Ç–µ —Å—Ç—Ä–∏–Ω–≥ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç—Å—è, –Ω–µ —Å—Ç–µ—Ä–µ–≤ —Å—Ç–∞—Ä—ã–π, –∏ –º—ã –ø–æ–ª—É—á–∞–µ–º —É—Ç–µ–∫—à–∏–π —Å—Ç—Ä–∏–Ω–≥. –í–æ–æ–±—â–µ, —Ç–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –µ—Å—Ç—å –¥–∞–ª–µ–∫–æ –Ω–µ –≤–µ–∑–¥–µ, –∏ –¥–∞–ª–µ–∫–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –≤—ã–∑–æ–≤–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã. –ù–æ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω–æ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–∞. –î–≤–æ–π–Ω–æ–π –∏–Ω–∏—Ç –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å —É—Ç–µ—á–∫—É. –ê –º–æ–∂–µ—Ç –Ω–µ –≤—ã–∑–≤–∞—Ç—å. –ö–∞–∂–¥—ã–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∞—Å—Å - –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å.

<a name="–∫–∞–∫–æ–π-–º–µ—Ç–æ–¥-–≤—ã–∑–æ–≤–µ—Ç—Å—è"></a>

## –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –≤—ã–∑–æ–≤–µ—Ç—Å—è: –∫–ª–∞—Å—Å–∞ A –∏–ª–∏ –∫–ª–∞—Å—Å–∞ B?

```objectivec
@interface A : NSObject
- (void)someMethod;
@end

@implementation A
- (void)someMethod {
  NSLog(@"This is class A");
}
@end

@interface B : A
@end

@implementation B
- (void)someMethod {
  NSLog(@"This is class B");
}
@end

@interface C : NSObject
@end

@implementation C
- (void)method {
  A *a = [B new];
  [a someMethod];
}
@end
```

–í—ã–∑–æ–≤–µ—Ç—Å—è –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞ B.

<a name="int8_t-matrix"></a>

## `int8_t matrix [2048][2024]`, –¥–æ–ø—É—Å—Ç–∏–º–æ –ª–∏?

2048 * 2024 = 4145152 –±–∞–π—Ç, —Ç–∞–∫ –∫–∞–∫ int8_t = 1 –±–∞–π—Ç. –ó–Ω–∞—á–∏—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–∞ –Ω—É–∂–Ω–æ 4.15 –º–µ–≥–∞–±–∞–π—Ç –ø–∞–º—è—Ç–∏ –≤ —Å—Ç–µ–∫–µ. –ù–∞ iOS —Ä–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 1 –º–µ–≥–∞–±–∞–π—Ç–æ–º, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ç–∞–∫–∞—è –∑–∞–ø–∏—Å—å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–∞.

<a name="memory-for-structs"></a>

## –û–¥–∏–Ω–∞–∫–æ–≤—É—é –ª–∏ –ø–∞–º—è—Ç—å –∑–∞–Ω–∏–º–∞—é—Ç —ç—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ø–æ—á–µ–º—É —Ç–∞–∫?

```c
struct StructA {
  int32_t a;
  char b;
  char c;
};

struct StructB {
  char b;
  int32_t a;
  char c;
};
```

```
sizeof(StructA) == 8
sizeof(StructB) == 12
```

–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –≤ –ø–∞–º—è—Ç–∏. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã) –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤ –ø–∞–º—è—Ç–∏ –ø–æ –∞–¥—Ä–µ—Å–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∞—Ç–Ω—ã –∏—Ö —Ä–∞–∑–º–µ—Ä—É. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–∏–º –¥–∞–Ω–Ω—ã–º –∏ –∏–∑–±–µ–≥–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∏—Ö —á—Ç–µ–Ω–∏–∏ –∏–ª–∏ –∑–∞–ø–∏—Å–∏.

```c
struct StructA {
  int32_t a;  // 4 –±–∞–π—Ç–∞
  char b;     // 1 –±–∞–π—Ç
  char c;     // 1 –±–∞–π—Ç
};

struct StructB {
  char b;     // 1 –±–∞–π—Ç
  int32_t a;  // 4 –±–∞–π—Ç–∞
  char c;     // 1 –±–∞–π—Ç
};
```
‚Ä¢	sizeof(StructA) == 8, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Å–ª–µ –ø–æ–ª—è a (4 –±–∞–π—Ç–∞) –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—Å—Ç–∞–≤–ª—è–µ—Ç 2 –±–∞–π—Ç–∞ –ø–∞–¥–¥–∏–Ω–≥–∞, —á—Ç–æ–±—ã –≤—ã—Ä–æ–≤–Ω—è—Ç—å –ø–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ 4 –±–∞–π—Ç–∞.

‚Ä¢	sizeof(StructB) == 12, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Å–ª–µ –ø–æ–ª—è b (1 –±–∞–π—Ç) –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è 3 –±–∞–π—Ç–∞ –ø–∞–¥–¥–∏–Ω–≥–∞ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –ø–æ–ª—è a (4 –±–∞–π—Ç–∞). –î–∞–ª–µ–µ —Å—Ç–æ–∏—Ç c (1 –±–∞–π—Ç), –∏ –µ—â–µ 2 –±–∞–π—Ç–∞ –ø–∞–¥–¥–∏–Ω–≥–∞.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–Ω–∏–º–∞—é—Ç —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏ –∏–∑-–∑–∞ –ø–æ—Ä—è–¥–∫–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª–µ–π –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

–ó–∞—á–µ–º –Ω—É–∂–Ω–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ?

–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –¥–∞–Ω–Ω—ã–º, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å–∞–º, –∫—Ä–∞—Ç–Ω—ã–º –∏—Ö —Ä–∞–∑–º–µ—Ä—É.

<a name="retain-in-class"></a>

## –ë—É–¥–µ—Ç –ª–∏ –≤—ã–∑–≤–∞–Ω deinit —É A –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ test()?

```swift
class A {
    var closure: (() -> Void)?
    deinit { print("A deinit") }
}

func test() {
    let a = A()
    a.closure = {
        print("Inside closure")
    }
}
```

–ù–µ—Ç, deinit –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç retain cycle:

‚Ä¢	a —Å–æ–¥–µ—Ä–∂–∏—Ç closure (—Å–∏–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –±–ª–æ–∫)

‚Ä¢	–±–ª–æ–∫ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç a (–Ω–µ—è–≤–Ω–æ, —á–µ—Ä–µ–∑ self), –∞ –∑–∞–º—ã–∫–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∏–ª—å–Ω–æ

```swift
/// –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
func test() {
    let a = A()
    a.closure = { [weak a] in
        print("Inside closure")
        // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–∂–Ω–æ: a?.doSomething()
    }
}
```

<a name="retain-in-vm"></a>

## –ë—É–¥–µ—Ç –ª–∏ –≤—ã–∑–≤–∞–Ω deinit —É ViewModel –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ test()? –ß—Ç–æ –Ω–µ —Ç–∞–∫? –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?

```swift
class ViewModel {
    var onUpdate: (() -> Void)?

    func fetchData() {
        DispatchQueue.global().async {
            sleep(1)
            self.onUpdate?()
        }
    }

    deinit {
        print("ViewModel deinit")
    }
}

func test() {
    let vm = ViewModel()
    vm.onUpdate = {
        print("UI updated")
    }
    vm.fetchData()
}
```

–ù–µ—Ç, deinit –ù–ï –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω –ø–æ—Å–ª–µ test() ‚Äî —Å–Ω–æ–≤–∞ –∏–∑-–∑–∞ retain cycle, –Ω–æ –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –æ–Ω –∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω:

1.	ViewModel ‚Üí onUpdate ‚Üí closure ‚Üí self (ViewModel)

2.	closure –¥–µ—Ä–∂–∏—Ç self, self –¥–µ—Ä–∂–∏—Ç closure ‚Äî —Ü–∏–∫–ª.

3.	closure –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, —á–µ—Ä–µ–∑ DispatchQueue, –∞ –∑–Ω–∞—á–∏—Ç, –æ–±—ä–µ–∫—Ç vm –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –¥–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞.

–ò –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã —Ç—ã –≤—Ä—É—á–Ω—É—é –∑–∞–Ω—É–ª—è–ª vm.onUpdate, —ç—Ç–æ –±—ã–ª–æ –±—ã –ø–æ–∑–¥–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ self —É–∂–µ –±—ã–ª–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–∞ –∑–∞–º—ã–∫–∞–Ω–∏–µ–º.

___

–ê —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ ViewModel –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ö—Ä–∞–Ω–∏—Ç –∑–∞–º—ã–∫–∞–Ω–∏–µ, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –≤ Combine: –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω deinit —É ViewModel, –∏ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–∫–∏?

```swift
class ViewModel {
    var cancellable: AnyCancellable?

    func bind() {
        cancellable = Timer.publish(every: 1, on: .main, in: .common)
            .autoconnect()
            .sink { _ in
                self.doSomething()
            }
    }

    func doSomething() {
        print("tick")
    }

    deinit {
        print("ViewModel deinit")
    }
}
```

self –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ sink, –∞ sink –∂–∏–≤—ë—Ç –≤ cancellable, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ self. –ü–æ–ª—É—á–∞–µ–º —Ü–∏–∫–ª.

–†–µ—à–µ–Ω–∏–µ ‚Äî [weak self] –≤–Ω—É—Ç—Ä–∏ .sink { [weak self] _ in ... }

<a name="web"></a>

## –ó–∞–¥–∞—á–∞ –Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞ –¥–µ–Ω—å –ø–æ—Å–µ—Ç–∏–ª–∏ —Ä–æ–≤–Ω–æ –¥–≤–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–µ–≤–∞–∂–Ω–æ, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–Ω–∏ –∑–∞—Ö–æ–¥–∏–ª–∏ –Ω–∞ –∫–∞–∂–¥—É—é –∏–∑ –Ω–∏—Ö, –Ω–æ –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö PageId).

1.	–£ –Ω–∞—Å –µ—Å—Ç—å –ª–æ–≥–∏ —Å –ø–æ–ª—è–º–∏:

‚Ä¢	Timestamp (–¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–µ—â–µ–Ω–∏—è)

‚Ä¢	PageId (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

‚Ä¢	CustomerId (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

2.	–ù—É–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (CustomerId) –∏ –¥–Ω—é (Timestamp).
3.	–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–æ–≤–Ω–æ 2 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö PageId –∑–∞ –¥–µ–Ω—å.

```swift
import Foundation

// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –ª–æ–≥–æ–≤
struct LogEntry {
    let timestamp: Date
    let pageId: Int
    let customerId: Int
}

// –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
let logs: [LogEntry] = [
    LogEntry(timestamp: Date(), pageId: 1, customerId: 100),
    LogEntry(timestamp: Date(), pageId: 2, customerId: 100),
    LogEntry(timestamp: Date(), pageId: 1, customerId: 100), // –ü–æ–≤—Ç–æ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã 1
    LogEntry(timestamp: Date(), pageId: 3, customerId: 101),
    LogEntry(timestamp: Date(), pageId: 4, customerId: 101),
    LogEntry(timestamp: Date(), pageId: 5, customerId: 102)
]

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ª–æ–≥–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –¥–Ω—è–º
func findUsersWithExactlyTwoUniquePages(logs: [LogEntry]) -> Set<Int> {
    var userPages: [Int: [Date: Set<Int>]] = [:] // –°–ª–æ–≤–∞—Ä—å: CustomerId -> [Date -> Set<PageId>]

    let calendar = Calendar.current

    for log in logs {
        let day = calendar.startOfDay(for: log.timestamp) // –£–ø—Ä–æ—â–∞–µ–º –¥–æ –¥–∞—Ç—ã –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏

        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å–ª–æ–≤–∞—Ä–µ, —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
        if userPages[log.customerId] == nil {
            userPages[log.customerId] = [:]
        }
        
        // –ï—Å–ª–∏ –¥–µ–Ω—å –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–∑–¥–∞–µ–º Set –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü
        if userPages[log.customerId]?[day] == nil {
            userPages[log.customerId]?[day] = Set()
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ Set
        userPages[log.customerId]?[day]?.insert(log.pageId)
    }

    // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–≤–Ω–æ –¥–≤—É–º—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
    var result = Set<Int>()
    for (customerId, days) in userPages {
        for (_, pages) in days {
            if pages.count == 2 {
                result.insert(customerId)
            }
        }
    }
    
    return result
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
let users = findUsersWithExactlyTwoUniquePages(logs: logs)
print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–æ—Å–µ—Ç–∏–≤—à–∏–µ —Ä–æ–≤–Ω–æ –¥–≤–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: \(users)")
```

‚Ä¢	–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: O(N), –≥–¥–µ N ‚Äî —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–∞—Ö.

‚Ä¢	–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö.

<a name="–ø–æ—Ä—è–¥–æ–∫"></a>

## –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞

```swift
import Foundation

let queue1 = DispatchQueue(label: "queue1", attributes: .concurrent)
let queue2 = DispatchQueue(label: "queue2")
let queue3 = DispatchQueue(label: "queue3")
let mainQueue = DispatchQueue.main

print("Start")
queue1.async {
    print("1")
    queue2.sync {
        print("2")
        queue3.async {
            print("3")
            mainQueue.sync {
                print("4")
            }
            print("5")
        }
        print("6")
    }
    print("7")
}
print("End")
```

```
Start
End
1
2
6
7
3
4
5
```

<a name="qos"></a>

## –ó–∞–¥–∞—á–∞ –Ω–∞ QOS

```swift
func log(_ message: String) {
    print("\(message) ‚Äî \(Thread.isMainThread ? "üü¢ main" : "üîµ background")")
}

print("üöÄ Start")

let queueA = DispatchQueue.global(qos: .background)
let queueB = DispatchQueue.global(qos: .userInitiated)
let queueC = DispatchQueue.global(qos: .utility)
let queueD = DispatchQueue.global(qos: .userInteractive)

queueA.async {
    log("A1 (background)")            // 1

    queueB.async {
        log("B1 (userInitiated)")      // 2

        queueC.async {
            log("C1 (utility)")        // 3

            queueD.async {
                log("D1 (userInteractive)")  // 4
            }

            log("C2 (utility)")        // 5
        }

        log("B2 (userInitiated)")      // 6
    }

    log("A2 (background)")            // 7
}

print("üöÄ End")

RunLoop.main.run(until: Date().addingTimeInterval(3))
```

```
üöÄ Start
üöÄ End
A1 (background)
A2 (background)
B1 (userInitiated)
B2 (userInitiated)
C1 (utility)
C2 (utility)
D1 (userInteractive)
```
–ù–æ –≤–æ–∑–º–æ–∂–Ω—ã –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏, –æ—Å–æ–±–µ–Ω–Ω–æ C1/C2 –∏ D1, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã. –û–¥–Ω–∞–∫–æ D1 —Å userInteractive QoS –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –±—ã—Å—Ç—Ä–µ–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª –≤–ª–æ–∂–µ–Ω –≤ utility.

‚Ä¢	queueA.async ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç), –Ω–æ –æ–Ω–∞ –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç.

‚Ä¢	queueB.async (–≤–Ω—É—Ç—Ä–∏ A) –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ.

‚Ä¢	–î–∞–∂–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –º–æ–≥—É—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å —Ä–∞–Ω—å—à–µ –≤–Ω–µ—à–Ω–∏—Ö, –µ—Å–ª–∏ —É –Ω–∏—Ö –≤—ã—à–µ QoS.

‚Ä¢	–í—Å–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ async –±–ª–æ–∫–∏ ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã, –æ–Ω–∏ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π –ø–æ —Å–≤–æ–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º.

<a name="dispatch"></a>

## –ó–∞–¥–∞—á–∞ –Ω–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—é

```swift
class Animal {
    func speak() {
        print("Animal speaks")
    }
}

// ‚úÖ Dog –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ—Ç–æ–¥ speak
class DogOverriding: Animal {
    override func speak() {
        print("DogOverriding barks")
    }
}

// üö´ Dog –ù–ï –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∞ –ø—Ä–æ—Å—Ç–æ –æ–±—ä—è–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥ —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º
class DogHiding: Animal {
    func speak() {
        print("DogHiding barks")
    }
}

print("== –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (override) ==")
let dog1 = DogOverriding()
dog1.speak()                          // DogOverriding barks

let animal1: Animal = DogOverriding()
animal1.speak()                       // DogOverriding barks (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è)

print("== –°–æ–∫—Ä—ã—Ç–∏–µ (method hiding) ==")
let dog2 = DogHiding()
dog2.speak()                          // DogHiding barks

let animal2: Animal = DogHiding()
animal2.speak()                       // Animal speaks (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è)
```

```
== –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (override) ==
DogOverriding barks
DogOverriding barks
== –°–æ–∫—Ä—ã—Ç–∏–µ (method hiding) ==
DogHiding barks
Animal speaks
```

## ‚ùó –ü–æ—á–µ–º—É `method hiding` ‚Äî –ø–ª–æ—Ö–∞—è –∏–¥–µ—è

| –ü—Ä–æ–±–ª–µ–º–∞                         | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|----------|
| üîç **–¢—Ä—É–¥–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏**         | –ü—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∫–æ–¥–∞ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ —Å–∞–±–∫–ª–∞—Å—Å–∞, –Ω–æ –Ω–∞ –¥–µ–ª–µ ‚Äî —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π. –≠—Ç–æ –∑–∞–ø—É—Ç—ã–≤–∞–µ—Ç. |
| ‚ö†Ô∏è **–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**     | –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç (`DogHiding`) –≤—ã–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Å—Å—ã–ª–∫–∏ (`Animal` –∏–ª–∏ `DogHiding`). |
| üö´ **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º** | –ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å `override`, –∞ –Ω–µ —Å "method hiding". |
| üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω–µ–µ**       | –ù—É–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ç–∏–ø–∞–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –∑–Ω–∞—Ç—å, –≥–¥–µ –º–æ–∂–µ—Ç –≤–Ω–µ–∑–∞–ø–Ω–æ –≤—ã–∑–≤–∞—Ç—å—Å—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –º–µ—Ç–æ–¥. |

## ‚úÖ –ö–æ–≥–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–∞–≤–¥–∞–Ω–æ

- –ö–æ–≥–¥–∞ —Ç—ã **–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ —Ö–æ—á–µ—à—å —Å–∫—Ä—ã—Ç—å** –º–µ—Ç–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–∞–±–∫–ª–∞—Å—Å **–ø–æ–ª–Ω–æ—Å—Ç—å—é –º–µ–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É**, –∏ –º–µ—Ç–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è **–Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω**.
- –ù–∞–ø—Ä–∏–º–µ—Ä: —É —Ç–µ–±—è —Å—Ç–∞—Ä—ã–π `BaseAPI` —Å `request()`, –∞ –≤ `NewAPI` —Ç—ã –¥–µ–ª–∞–µ—à—å —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `request()` –±–µ–∑ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è.

> ‚ö†Ô∏è –ù–æ –¥–∞–∂–µ —Ç–æ–≥–¥–∞ –ª—É—á—à–µ **–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥**, –∞ –Ω–µ —Å–∫—Ä—ã–≤–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π.

## üß† –í—ã–≤–æ–¥

> **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–∫—Ä—ã–≤–∞–π –º–µ—Ç–æ–¥—ã —Ä–æ–¥–∏—Ç–µ–ª—è, –µ—Å–ª–∏ –º–æ–∂–µ—à—å —ç—Ç–æ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å.**
>
> –ò—Å–ø–æ–ª—å–∑—É–π `override`, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ.